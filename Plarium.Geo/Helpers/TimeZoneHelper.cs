namespace Plarium.Geo.Helpers
{
    using System;
    using System.Collections.Generic;
    using System.Text;

    public class TimeZoneHelper
    {
        private const string DefaultOffset = "+00";
        private static TimeZoneHelper _default;
        public readonly Dictionary<string, string> timezoneOffsetDictionary;
        public readonly Dictionary<string, string> countryOffsetDictionary;

        private TimeZoneHelper()
        {
            this.timezoneOffsetDictionary = new Dictionary<string, string>
{
{"Europe/Andorra","+01"},
{"Asia/Dubai","+04"},
{"Asia/Kabul","+04:30"},
{"America/Antigua","-04"},
{"America/Anguilla","-04"},
{"Europe/Tirane","+01"},
{"Asia/Yerevan","+04"},
{"Africa/Luanda","+01"},
{"Antarctica/McMurdo","+12"},
{"Antarctica/Rothera","+00"},
{"Antarctica/Palmer","-03"},
{"Antarctica/Mawson","+06"},
{"Antarctica/Davis","+07"},
{"Antarctica/Casey","+08"},
{"Antarctica/Vostok","+06"},
{"Antarctica/DumontDUrville","+10"},
{"Antarctica/Syowa","+03"},
{"Antarctica/Troll","+00"},
{"America/Argentina/Buenos_Aires","-03"},
{"America/Argentina/Cordoba","-03"},
{"America/Argentina/Salta","-03"},
{"America/Argentina/Jujuy","-03"},
{"America/Argentina/Tucuman","-03"},
{"America/Argentina/Catamarca","-03"},
{"America/Argentina/La_Rioja","-03"},
{"America/Argentina/San_Juan","-03"},
{"America/Argentina/Mendoza","-03"},
{"America/Argentina/San_Luis","-03"},
{"America/Argentina/Rio_Gallegos","-03"},
{"America/Argentina/Ushuaia","-03"},
{"Pacific/Pago_Pago","-11"},
{"Europe/Vienna","+01"},
{"Australia/Lord_Howe","+10"},
{"Antarctica/Macquarie","+11"},
{"Australia/Hobart","+11"},
{"Australia/Currie","+10"},
{"Australia/Melbourne","+10"},
{"Australia/Sydney","+10"},
{"Australia/Broken_Hill","+09:30"},
{"Australia/Brisbane","+10"},
{"Australia/Lindeman","+10"},
{"Australia/Adelaide","+09:30"},
{"Australia/Darwin","+09:30"},
{"Australia/Perth","+08"},
{"Australia/Eucla","+08:45"},
{"America/Aruba","-04"},
{"Europe/Mariehamn","+02"},
{"Asia/Baku","+04"},
{"Europe/Sarajevo","+01"},
{"America/Barbados","-04"},
{"Asia/Dhaka","+06"},
{"Europe/Brussels","+01"},
{"Africa/Ouagadougou","+00"},
{"Europe/Sofia","+02"},
{"Asia/Bahrain","+04"},
{"Africa/Bujumbura","+02"},
{"Africa/Porto-Novo","+01"},
{"America/St_Barthelemy","-04"},
{"Atlantic/Bermuda","-04"},
{"Asia/Brunei","+08"},
{"America/La_Paz","-04"},
{"America/Kralendijk","-04"},
{"America/Noronha","-02"},
{"America/Belem","-03"},
{"America/Fortaleza","-03"},
{"America/Recife","-03"},
{"America/Araguaina","-03"},
{"America/Maceio","-03"},
{"America/Bahia","-03"},
{"America/Sao_Paulo","-03"},
{"America/Campo_Grande","-04"},
{"America/Cuiaba","-04"},
{"America/Santarem","-04"},
{"America/Porto_Velho","-04"},
{"America/Boa_Vista","-04"},
{"America/Manaus","-04"},
{"America/Eirunepe","-05"},
{"America/Rio_Branco","-05"},
{"America/Nassau","-05"},
{"Asia/Thimphu","+05:30"},
{"Africa/Gaborone","+02"},
{"Europe/Minsk","+03"},
{"America/Belize","-06"},
{"America/St_Johns","-03:30"},
{"America/Halifax","-04"},
{"America/Glace_Bay","-04"},
{"America/Moncton","-04"},
{"America/Goose_Bay","-04"},
{"America/Blanc-Sablon","-04"},
{"America/Toronto","-05"},
{"America/Nipigon","-05"},
{"America/Thunder_Bay","-05"},
{"America/Iqaluit","-05"},
{"America/Pangnirtung","-04"},
{"America/Resolute","-06"},
{"America/Atikokan","-05"},
{"America/Rankin_Inlet","-06"},
{"America/Winnipeg","-06"},
{"America/Rainy_River","-06"},
{"America/Regina","-06"},
{"America/Swift_Current","-07"},
{"America/Edmonton","-07"},
{"America/Cambridge_Bay","-07"},
{"America/Yellowknife","-07"},
{"America/Inuvik","-08"},
{"America/Creston","-07"},
{"America/Dawson_Creek","-08"},
{"America/Vancouver","-08"},
{"America/Whitehorse","-08"},
{"America/Dawson","-09"},
{"Indian/Cocos","+06:30"},
{"Africa/Kinshasa","+01"},
{"Africa/Lubumbashi","+02"},
{"Africa/Bangui","+01"},
{"Africa/Brazzaville","+01"},
{"Europe/Zurich","+01"},
{"Africa/Abidjan","+00"},
{"Pacific/Rarotonga","-10:30"},
{"America/Santiago","-03"},
{"Pacific/Easter","-06"},
{"Africa/Douala","+01"},
{"Asia/Shanghai","+08"},
{"Asia/Urumqi","+06"},
{"America/Bogota","-05"},
{"America/Costa_Rica","-06"},
{"America/Havana","-05"},
{"Atlantic/Cape_Verde","-02"},
{"America/Curacao","-04"},
{"Indian/Christmas","+07"},
{"Asia/Nicosia","+02"},
{"Europe/Prague","+01"},
{"Europe/Berlin","+01"},
{"Europe/Busingen","+01"},
{"Africa/Djibouti","+03"},
{"Europe/Copenhagen","+01"},
{"America/Dominica","-04"},
{"America/Santo_Domingo","-04:30"},
{"Africa/Algiers","+00"},
{"America/Guayaquil","-05"},
{"Pacific/Galapagos","-05"},
{"Europe/Tallinn","+03"},
{"Africa/Cairo","+02"},
{"Africa/El_Aaiun","-01"},
{"Africa/Asmara","+03"},
{"Europe/Madrid","+01"},
{"Africa/Ceuta","+00"},
{"Atlantic/Canary","+00"},
{"Africa/Addis_Ababa","+03"},
{"Europe/Helsinki","+02"},
{"Pacific/Fiji","+12"},
{"Atlantic/Stanley","-04"},
{"Pacific/Chuuk","+10"},
{"Pacific/Pohnpei","+11"},
{"Pacific/Kosrae","+12"},
{"Atlantic/Faroe","+00"},
{"Europe/Paris","+01"},
{"Africa/Libreville","+01"},
{"Europe/London","+01"},
{"America/Grenada","-04"},
{"Asia/Tbilisi","+04"},
{"America/Cayenne","-03"},
{"Europe/Guernsey","+01"},
{"Africa/Accra","+00"},
{"Europe/Gibraltar","+01"},
{"America/Godthab","-03"},
{"America/Danmarkshavn","-03"},
{"America/Scoresbysund","-02"},
{"America/Thule","-04"},
{"Africa/Banjul","+00"},
{"Africa/Conakry","+00"},
{"America/Guadeloupe","-04"},
{"Africa/Malabo","+01"},
{"Europe/Athens","+02"},
{"Atlantic/South_Georgia","-02"},
{"America/Guatemala","-06"},
{"Pacific/Guam","+10"},
{"Africa/Bissau","-01"},
{"America/Guyana","-03:45"},
{"Asia/Hong_Kong","+08"},
{"America/Tegucigalpa","-06"},
{"Europe/Zagreb","+01"},
{"America/Port-au-Prince","-05"},
{"Europe/Budapest","+01"},
{"Asia/Jakarta","+07"},
{"Asia/Pontianak","+08"},
{"Asia/Makassar","+08"},
{"Asia/Jayapura","+09"},
{"Europe/Dublin","+01"},
{"Asia/Jerusalem","+02"},
{"Europe/Isle_of_Man","+01"},
{"Asia/Kolkata","+05:30"},
{"Indian/Chagos","+05"},
{"Asia/Baghdad","+03"},
{"Asia/Tehran","+03:30"},
{"Atlantic/Reykjavik","+00"},
{"Europe/Rome","+01"},
{"Europe/Jersey","+01"},
{"America/Jamaica","-05"},
{"Asia/Amman","+02"},
{"Asia/Tokyo","+09"},
{"Africa/Nairobi","+03"},
{"Asia/Bishkek","+06"},
{"Asia/Phnom_Penh","+07"},
{"Pacific/Tarawa","+12"},
{"Pacific/Enderbury","-12"},
{"Pacific/Kiritimati","-10:40"},
{"Indian/Comoro","+03"},
{"America/St_Kitts","-04"},
{"Asia/Pyongyang","+09"},
{"Asia/Seoul","+09"},
{"Asia/Kuwait","+03"},
{"America/Cayman","-05"},
{"Asia/Almaty","+06"},
{"Asia/Qyzylorda","+05"},
{"Asia/Aqtobe","+05"},
{"Asia/Aqtau","+05"},
{"Asia/Oral","+05"},
{"Asia/Vientiane","+07"},
{"Asia/Beirut","+02"},
{"America/St_Lucia","-04"},
{"Europe/Vaduz","+01"},
{"Asia/Colombo","+05:30"},
{"Africa/Monrovia","-00:44:30"},
{"Africa/Maseru","+02"},
{"Europe/Vilnius","+03"},
{"Europe/Luxembourg","+01"},
{"Europe/Riga","+03"},
{"Africa/Tripoli","+02"},
{"Africa/Casablanca","+00"},
{"Europe/Monaco","+01"},
{"Europe/Chisinau","+03"},
{"Europe/Podgorica","+01"},
{"America/Marigot","-04"},
{"Indian/Antananarivo","+03"},
{"Pacific/Majuro","+12"},
{"Pacific/Kwajalein","-12"},
{"Europe/Skopje","+01"},
{"Africa/Bamako","+00"},
{"Asia/Rangoon","+06:30"},
{"Asia/Ulaanbaatar","+07"},
{"Asia/Hovd","+06"},
{"Asia/Choibalsan","+07"},
{"Asia/Macau","+08"},
{"Pacific/Saipan","+10"},
{"America/Martinique","-04"},
{"Africa/Nouakchott","+00"},
{"America/Montserrat","-04"},
{"Europe/Malta","+01"},
{"Indian/Mauritius","+04"},
{"Indian/Maldives","+05"},
{"Africa/Blantyre","+02"},
{"America/Mexico_City","-06"},
{"America/Cancun","-06"},
{"America/Merida","-06"},
{"America/Monterrey","-06"},
{"America/Matamoros","-06"},
{"America/Mazatlan","-08"},
{"America/Chihuahua","-06"},
{"America/Ojinaga","-06"},
{"America/Hermosillo","-08"},
{"America/Tijuana","-08"},
{"America/Santa_Isabel","-08"},
{"America/Bahia_Banderas","-08"},
{"Asia/Kuala_Lumpur","+07:30"},
{"Asia/Kuching","+08"},
{"Africa/Maputo","+02"},
{"Africa/Windhoek","+02"},
{"Pacific/Noumea","+11"},
{"Africa/Niamey","+01"},
{"Pacific/Norfolk","+11:30"},
{"Africa/Lagos","+01"},
{"America/Managua","-06"},
{"Europe/Amsterdam","+01"},
{"Europe/Oslo","+01"},
{"Asia/Kathmandu","+05:30"},
{"Pacific/Nauru","+11:30"},
{"Pacific/Niue","-11:30"},
{"Pacific/Auckland","+12"},
{"Pacific/Chatham","+12:45"},
{"Asia/Muscat","+04"},
{"America/Panama","-05"},
{"America/Lima","-05"},
{"Pacific/Tahiti","-10"},
{"Pacific/Marquesas","-09:30"},
{"Pacific/Gambier","-09"},
{"Pacific/Port_Moresby","+10"},
{"Pacific/Bougainville","+10"},
{"Asia/Manila","+08"},
{"Asia/Karachi","+05"},
{"Europe/Warsaw","+01"},
{"America/Miquelon","-04"},
{"Pacific/Pitcairn","-08:30"},
{"America/Puerto_Rico","-04"},
{"Asia/Gaza","+02"},
{"Asia/Hebron","+02"},
{"Europe/Lisbon","+01"},
{"Atlantic/Madeira","+00"},
{"Atlantic/Azores","-01"},
{"Pacific/Palau","+09"},
{"America/Asuncion","-04"},
{"Asia/Qatar","+04"},
{"Indian/Reunion","+04"},
{"Europe/Bucharest","+02"},
{"Europe/Belgrade","+01"},
{"Europe/Kaliningrad","+03"},
{"Europe/Moscow","+03"},
{"Europe/Simferopol","+03"},
{"Europe/Volgograd","+04"},
{"Europe/Samara","+04"},
{"Asia/Yekaterinburg","+05"},
{"Asia/Omsk","+06"},
{"Asia/Novosibirsk","+07"},
{"Asia/Novokuznetsk","+07"},
{"Asia/Krasnoyarsk","+07"},
{"Asia/Irkutsk","+08"},
{"Asia/Chita","+09"},
{"Asia/Yakutsk","+09"},
{"Asia/Khandyga","+09"},
{"Asia/Vladivostok","+10"},
{"Asia/Sakhalin","+11"},
{"Asia/Ust-Nera","+09"},
{"Asia/Magadan","+11"},
{"Asia/Srednekolymsk","+11"},
{"Asia/Kamchatka","+12"},
{"Asia/Anadyr","+13"},
{"Africa/Kigali","+02"},
{"Asia/Riyadh","+03"},
{"Pacific/Guadalcanal","+11"},
{"Indian/Mahe","+04"},
{"Africa/Khartoum","+02"},
{"Europe/Stockholm","+01"},
{"Asia/Singapore","+07:30"},
{"Atlantic/St_Helena","+00"},
{"Europe/Ljubljana","+01"},
{"Arctic/Longyearbyen","+01"},
{"Europe/Bratislava","+01"},
{"Africa/Freetown","+00"},
{"Europe/San_Marino","+01"},
{"Africa/Dakar","+00"},
{"Africa/Mogadishu","+03"},
{"America/Paramaribo","-03:30"},
{"Africa/Juba","+02"},
{"Africa/Sao_Tome","+00"},
{"America/El_Salvador","-06"},
{"America/Lower_Princes","-04"},
{"Asia/Damascus","+02"},
{"Africa/Mbabane","+02"},
{"America/Grand_Turk","-05"},
{"Africa/Ndjamena","+01"},
{"Indian/Kerguelen","+05"},
{"Africa/Lome","+00"},
{"Asia/Bangkok","+07"},
{"Asia/Dushanbe","+06"},
{"Pacific/Fakaofo","-11"},
{"Asia/Dili","+09"},
{"Asia/Ashgabat","+05"},
{"Africa/Tunis","+01"},
{"Pacific/Tongatapu","+13"},
{"Europe/Istanbul","+02"},
{"America/Port_of_Spain","-04"},
{"Pacific/Funafuti","+12"},
{"Asia/Taipei","+08"},
{"Africa/Dar_es_Salaam","+03"},
{"Europe/Kiev","+03"},
{"Europe/Uzhgorod","+03"},
{"Europe/Zaporozhye","+03"},
{"Africa/Kampala","+03"},
{"Pacific/Johnston","-10"},
{"Pacific/Midway","-11"},
{"Pacific/Wake","+12"},
{"America/New_York","-05"},
{"America/Detroit","-05"},
{"America/Kentucky/Louisville","-05"},
{"America/Kentucky/Monticello","-06"},
{"America/Indiana/Indianapolis","-05"},
{"America/Indiana/Vincennes","-05"},
{"America/Indiana/Winamac","-05"},
{"America/Indiana/Marengo","-05"},
{"America/Indiana/Petersburg","-06"},
{"America/Indiana/Vevay","-05"},
{"America/Chicago","-06"},
{"America/Indiana/Tell_City","-05"},
{"America/Indiana/Knox","-06"},
{"America/Menominee","-05"},
{"America/North_Dakota/Center","-07"},
{"America/North_Dakota/New_Salem","-07"},
{"America/North_Dakota/Beulah","-07"},
{"America/Denver","-07"},
{"America/Boise","-07"},
{"America/Phoenix","-07"},
{"America/Los_Angeles","-08"},
{"America/Metlakatla","-08"},
{"America/Anchorage","-10"},
{"America/Juneau","-08"},
{"America/Sitka","-08"},
{"America/Yakutat","-09"},
{"America/Nome","-11"},
{"America/Adak","-11"},
{"Pacific/Honolulu","-10"},
{"America/Montevideo","-03"},
{"Asia/Samarkand","+05"},
{"Asia/Tashkent","+06"},
{"Europe/Vatican","+01"},
{"America/St_Vincent","-04"},
{"America/Caracas","-04"},
{"America/Tortola","-04"},
{"America/St_Thomas","-04"},
{"Asia/Ho_Chi_Minh","+08"},
{"Pacific/Efate","+11"},
{"Pacific/Wallis","+12"},
{"Pacific/Apia","-11"},
{"Asia/Aden","+03"},
{"Indian/Mayotte","+03"},
{"Africa/Johannesburg","+02"},
{"Africa/Lusaka","+02"},
{"Africa/Harare","+02"}
};

            this.countryOffsetDictionary = new Dictionary<string, string>
{
{"AD","+01"},
{"AE","+04"},
{"AF","+04:30"},
{"AG","-04"},
{"AI","-04"},
{"AL","+01"},
{"AM","+04"},
{"AO","+01"},
{"AQ","+12"},
{"AR","-03"},
{"AS","-11"},
{"AT","+01"},
{"AU","+10"},
{"AW","-04"},
{"AX","+02"},
{"AZ","+04"},
{"BA","+01"},
{"BB","-04"},
{"BD","+06"},
{"BE","+01"},
{"BF","+00"},
{"BG","+02"},
{"BH","+04"},
{"BI","+02"},
{"BJ","+01"},
{"BL","-04"},
{"BM","-04"},
{"BN","+08"},
{"BO","-04"},
{"BQ","-04"},
{"BR","-02"},
{"BS","-05"},
{"BT","+05:30"},
{"BW","+02"},
{"BY","+03"},
{"BZ","-06"},
{"CA","-03:30"},
{"CC","+06:30"},
{"CD","+01"},
{"CF","+01"},
{"CG","+01"},
{"CH","+01"},
{"CI","+00"},
{"CK","-10:30"},
{"CL","-03"},
{"CM","+01"},
{"CN","+08"},
{"CO","-05"},
{"CR","-06"},
{"CU","-05"},
{"CV","-02"},
{"CW","-04"},
{"CX","+07"},
{"CY","+02"},
{"CZ","+01"},
{"DE","+01"},
{"DJ","+03"},
{"DK","+01"},
{"DM","-04"},
{"DO","-04:30"},
{"DZ","+00"},
{"EC","-05"},
{"EE","+03"},
{"EG","+02"},
{"EH","-01"},
{"ER","+03"},
{"ES","+01"},
{"ET","+03"},
{"FI","+02"},
{"FJ","+12"},
{"FK","-04"},
{"FM","+10"},
{"FO","+00"},
{"FR","+01"},
{"GA","+01"},
{"GB","+01"},
{"GD","-04"},
{"GE","+04"},
{"GF","-03"},
{"GG","+01"},
{"GH","+00"},
{"GI","+01"},
{"GL","-03"},
{"GM","+00"},
{"GN","+00"},
{"GP","-04"},
{"GQ","+01"},
{"GR","+02"},
{"GS","-02"},
{"GT","-06"},
{"GU","+10"},
{"GW","-01"},
{"GY","-03:45"},
{"HK","+08"},
{"HN","-06"},
{"HR","+01"},
{"HT","-05"},
{"HU","+01"},
{"ID","+07"},
{"IE","+01"},
{"IL","+02"},
{"IM","+01"},
{"IN","+05:30"},
{"IO","+05"},
{"IQ","+03"},
{"IR","+03:30"},
{"IS","+00"},
{"IT","+01"},
{"JE","+01"},
{"JM","-05"},
{"JO","+02"},
{"JP","+09"},
{"KE","+03"},
{"KG","+06"},
{"KH","+07"},
{"KI","+12"},
{"KM","+03"},
{"KN","-04"},
{"KP","+09"},
{"KR","+09"},
{"KW","+03"},
{"KY","-05"},
{"KZ","+06"},
{"LA","+07"},
{"LB","+02"},
{"LC","-04"},
{"LI","+01"},
{"LK","+05:30"},
{"LR","-00:44:30"},
{"LS","+02"},
{"LT","+03"},
{"LU","+01"},
{"LV","+03"},
{"LY","+02"},
{"MA","+00"},
{"MC","+01"},
{"MD","+03"},
{"ME","+01"},
{"MF","-04"},
{"MG","+03"},
{"MH","+12"},
{"MK","+01"},
{"ML","+00"},
{"MM","+06:30"},
{"MN","+07"},
{"MO","+08"},
{"MP","+10"},
{"MQ","-04"},
{"MR","+00"},
{"MS","-04"},
{"MT","+01"},
{"MU","+04"},
{"MV","+05"},
{"MW","+02"},
{"MX","-06"},
{"MY","+07:30"},
{"MZ","+02"},
{"NA","+02"},
{"NC","+11"},
{"NE","+01"},
{"NF","+11:30"},
{"NG","+01"},
{"NI","-06"},
{"NL","+01"},
{"NO","+01"},
{"NP","+05:30"},
{"NR","+11:30"},
{"NU","-11:30"},
{"NZ","+12"},
{"OM","+04"},
{"PA","-05"},
{"PE","-05"},
{"PF","-10"},
{"PG","+10"},
{"PH","+08"},
{"PK","+05"},
{"PL","+01"},
{"PM","-04"},
{"PN","-08:30"},
{"PR","-04"},
{"PS","+02"},
{"PT","+01"},
{"PW","+09"},
{"PY","-04"},
{"QA","+04"},
{"RE","+04"},
{"RO","+02"},
{"RS","+01"},
{"RU","+03"},
{"RW","+02"},
{"SA","+03"},
{"SB","+11"},
{"SC","+04"},
{"SD","+02"},
{"SE","+01"},
{"SG","+07:30"},
{"SH","+00"},
{"SI","+01"},
{"SJ","+01"},
{"SK","+01"},
{"SL","+00"},
{"SM","+01"},
{"SN","+00"},
{"SO","+03"},
{"SR","-03:30"},
{"SS","+02"},
{"ST","+00"},
{"SV","-06"},
{"SX","-04"},
{"SY","+02"},
{"SZ","+02"},
{"TC","-05"},
{"TD","+01"},
{"TF","+05"},
{"TG","+00"},
{"TH","+07"},
{"TJ","+06"},
{"TK","-11"},
{"TL","+09"},
{"TM","+05"},
{"TN","+01"},
{"TO","+13"},
{"TR","+02"},
{"TT","-04"},
{"TV","+12"},
{"TW","+08"},
{"TZ","+03"},
{"UA","+03"},
{"UG","+03"},
{"UM","-10"},
{"US","-05"},
{"UY","-03"},
{"UZ","+05"},
{"VA","+01"},
{"VC","-04"},
{"VE","-04"},
{"VG","-04"},
{"VI","-04"},
{"VN","+08"},
{"VU","+11"},
{"WF","+12"},
{"WS","-11"},
{"YE","+03"},
{"YT","+03"},
{"ZA","+02"},
{"ZM","+02"},
{"ZW","+02"}                                               
};
        }

        public static TimeZoneHelper Default
        {
            get
            {
                return _default ?? (_default = new TimeZoneHelper());
            }
        }

        public string GetUtcOffsetAnyway(string countryCode, string timezone)
        {
            string offset;
            if (!string.IsNullOrEmpty(timezone))
            {
                offset = this.GetUtcOffsetByTimezone(timezone);
            }
            else
            {
                offset = this.GetUtcOffsetByCountry(countryCode);
            }

            return offset;
        }

        public string GetUtcOffsetByCountry(string countryCode)
        {
            string offset;
            if (!this.countryOffsetDictionary.TryGetValue(countryCode, out offset))
            {
                offset = DefaultOffset;
            }

            return offset;
        }

        public string GetUtcOffsetByTimezone(string timezone)
        {
            string offset;
            if (!this.timezoneOffsetDictionary.TryGetValue(timezone, out offset))
            {
                offset = DefaultOffset;
            }

            return offset;
        }

        public byte TimezoneToByte(string code)
        {
            var sb = new StringBuilder();
            bool negative = false;

            for (int i = 0; i < code.Length - 1; i++)
            {
                if (i == 0)
                {
                    negative = code[i].Equals('-');
                    continue;
                }
                if (code[i].Equals(':'))
                {
                    continue;
                }
                sb.Append(code[i]);
            }

            var val = Convert.ToByte(sb.ToString());

            if (negative)
            {
                val += 128;
            }

            return val;
        }
    }
}
